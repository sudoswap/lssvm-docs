<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>Wrapped Pools - sudoswap docs</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
        <link href="../../extra.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Wrapped Pools";
        var mkdocs_page_input_path = "reference\\wrapped-pools.md";
        var mkdocs_page_url = null;
      </script>
    
    <script src="../../js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> sudoswap docs
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">What Is Sudoswap?</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Sudoswap v2</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../v2/overview/">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../v2/royalties/">Royalties</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../v2/settings/">Settings</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../v2/properties/">Property Checking</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../v2/erc1155/">ERC1155 NFTs</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">User Guide</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../user-guide/buying-and-selling/">Buying and Selling NFTs</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../user-guide/creating-a-pool/">Creating a Liquidity Pool</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../user-guide/creating-an-auction/">Creating an Auction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../user-guide/faq/">Frequently Asked Questions (FAQ)</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Managing Collections</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../managing-collections/listing/">Launching on Sudoswap</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../managing-collections/faq/">Frequently Asked Questions (FAQ)</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Technical Reference</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../pair-creation/">Pair Creation</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../pricing/">Bonding Curves and Pricing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../swapping/">Swapping Across Pairs</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../property-checkers/">Cloning Property Checkers</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="./">Wrapped Pools</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#overview">Overview</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#example">Example</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#integrating-wrapped-pools">Integrating Wrapped Pools</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#example_1">Example</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#valuing-wrapped-pools">Valuing Wrapped Pools</a>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../contracts/">Contract Addresses</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">sudoswap docs</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" alt="Docs"></a> &raquo;</li>
          <li>Technical Reference &raquo;</li>
      <li>Wrapped Pools</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="wrapped-pools">Wrapped Pools</h1>
<p>sudoswap pools can be wrapped as ERC721 NFTs using the wrapper contract deployed at <a href="https://etherscan.io/address/0x3767341a7519178f30281fc7D07538EDb55c05a4">0x3767341a7519178f30281fc7D07538EDb55c05a4</a>. This allows pools to be utilized within any NFT-compatible protocol, for purposes such as lending or fractionalization.</p>
<p>At this time, the wrapper contract only supports ERC721&lt;&gt;ETH pools.</p>
<h2 id="overview">Overview</h2>
<p>To wrap a pool, the owner transfers the pool to the wrapper contract using the <code>transferOwnership</code> method on the pool contract:</p>
<p><code>LSSVMPair.transferOwnership(0x3767341a7519178f30281fc7D07538EDb55c05a4,)</code></p>
<p>Then, using the <code>onOwnershipTransferred</code> callback, the wrapper contract  mints an ERC721 NFT representing ownership of the wrapped pool to its original owner. The tokenId of the NFT is the contract address of the underlying pool casted to an unsigned integer:</p>
<p><code>tokenId = uint256(uint160(pairAddress))</code></p>
<p>The holder of a wrapper NFT has full and exclusive control over the underlying pool. Via the wrapper contract, they can:</p>
<ul>
<li>change pool settings such as pricing using the <code>multicall</code> proxy method,</li>
<li>unwrap the pool using the <code>reclaimPairs</code> method, which transfers them ownership of the pool and subsequently burns the NFT.</li>
</ul>
<h3 id="example">Example</h3>
<pre><code class="language-sol">WrappedSudoPool wrapper = WrappedSudoPool(0x3767341a7519178f30281fc7D07538EDb55c05a4);
wrapper.reclaimPairs([LSSVMPair1,...]);
</code></pre>
<h2 id="integrating-wrapped-pools">Integrating Wrapped Pools</h2>
<p>Since wrapper NFTs conform to ERC721, they are natively compatible with most NFT protocols.</p>
<p>To get information about an underlying pool, start by casting the NFT's tokenId back into the pool's address:</p>
<p><code>pairAddress = address(uint160(tokenId))</code></p>
<p>Then, read the views inherited from <a href="https://github.com/sudoswap/lssvm2/blob/main/src/LSSVMPair.sol"><code>LSSVMPair.sol</code></a> on that address to determine the pool's parameters:</p>
<ul>
<li><code>pairVariant()</code> (only <code>ETH</code> pools are supported by the wrapper)</li>
<li><code>bondingCurve()</code> (linear, exponential, etc)</li>
<li><code>nft()</code> (contract address)</li>
<li><code>poolType()</code> (BUY, SELL, or TRADE)</li>
<li>and more.</li>
</ul>
<p>You can read a pool's ETH balance using the <code>balance</code> property. To determine the pool's NFT balance, call <code>balanceOf()</code> on the NFT contract itself.</p>
<h3 id="example_1">Example</h3>
<pre><code class="language-sol">import { ILSSVMPair } from &quot;./ILSSVMPair.sol&quot;;

contract Example {
  function _handleNFT(address _tokenContract, uint256 _tokenId) internal {

      // Check if NFT is a wrapped sudoswap pool
      if (_tokenContract == 0x3767341a7519178f30281fc7D07538EDb55c05a4) {

          // Get underlying pool
          ILSSVMPair underlyingPair = ILSSVMPair(address(uint160(_tokenId)));

          // Get information about pool
          address nft = underlyingPair.nft(); // Underlying NFT contract
          ILSSVMPair.PoolType type = underlyingPair.poolType(); // BUY, SELL, or TRADE
          address curve = underlyingPair.bondingCurve(); // Address of bonding curve
          uint256 balance = underlyingPair.balance; // ETH balance of pool

          // Do desired logic
          ...
      } else {...}
  }
}
</code></pre>
<h2 id="valuing-wrapped-pools">Valuing Wrapped Pools</h2>
<p>Valuing wrapped pools can be complex due to diverse pricing curves and the risk of manipulation. To mitigate this, we recommend protocols start by only integrating certain categories of sudoswap pools.</p>
<p>For example, for a buy- or sell-only pool using a linear or exponential pricing curve, the total value of the pool can be estimated by multiplying its NFT balance by the NFT's floor price (as provided by an NFT valuation oracle of choice) and adding its ETH balance.</p>
<p>Additionally, you should check the pool's pricing at the time of valuation is equal to the NFT's floor price or better. For a linear or exponential pricing curve, this means:</p>
<ul>
<li>Buy-only pools: <code>spotPrice</code> ≤ <code>floor</code></li>
<li>Sell-only pools: <code>spoPrice</code> ≥ <code>floor</code></li>
</ul>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../property-checkers/" class="btn btn-neutral float-left" title="Cloning Property Checkers"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../contracts/" class="btn btn-neutral float-right" title="Contract Addresses">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../property-checkers/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../contracts/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme_extra.js" defer></script>
    <script src="../../js/theme.js" defer></script>
      <script src="../../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
